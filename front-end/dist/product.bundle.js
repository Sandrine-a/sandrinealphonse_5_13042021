(()=>{"use strict";var e="localhost"===location.hostname||"127.0.0.1"===location.hostname?"http://localhost:3000":"https://orinoco-cameras-shop.herokuapp.com",t=JSON.parse(localStorage.getItem("article"));function n(e,t,n,r,a,o,c){try{var i=e[o](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var c=e.apply(t,r);function i(e){n(c,a,o,i,s,"next",e)}function s(e){n(c,a,o,i,s,"throw",e)}i(void 0)}))}}document.querySelector(".control__panier--total");var a=window.location.search.substring(4),o="".concat(e,"/api/cameras/").concat(a),c=document.getElementById("article__display"),i=document.getElementById("ajout"),s={},l={},u=document.getElementById("ajout__btn");u.addEventListener("click",(function(e){return y.apply(this,arguments)}));var d=document.getElementById("order__btn");window.addEventListener("storage",v);var p=document.getElementById("nombre");p.addEventListener("change",(function(){var e,t=p.options[p.selectedIndex].text,n=s.price*t/100,r=document.querySelector(".total__prix");for(var a in r.innerHTML="\n  ".concat(n," €\n  "),t)e={name:s.name,id:s._id,price:s.price/100,qty:Number(t),img:s.imageUrl};l=e}));var m=fetch(o).then((function(e){return e.json()})).then((function(e){s=e})).catch((function(e){c.innerHTML=' <p class="col text-info">Une erreur est survenue, nous vous prions de bien vouloir réessayer dans un instant.</P>'+e}));function f(){return h.apply(this,arguments)}function h(){return(h=r(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m;case 2:for(t in c.innerHTML='\n  <img class="card-img-top pt-2" src="'.concat(s.imageUrl,'"/>\n  <h2 class="card-title mt-3">').concat(s.name,'</h2>\n  <div class="card-text">\n    <p>').concat(s.description,'</p> \n    <p class="h6">Prix: ').concat(s.price/100,' € <p>\n    <form>\n      <label for="lentilles" class="col-12"> Choisissez l\'option de lentille </label>\n      <select name="lentilles" id="lentilles">\n      </select>\n    </form>\n  </div> \n  '),s.lenses)n=document.getElementById("lentilles"),(r=document.createElement("option")).innerHTML="\n    <option value=".concat(s.lenses[t],">").concat(s.lenses[t],"</option>\n    "),n.appendChild(r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(){return g.apply(this,arguments)}function g(){return(g=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:null!=localStorage.getItem("article")&&(d.removeAttribute("disabled"),d.classList.replace("btn-primary","btn-info"));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=r(regeneratorRuntime.mark((function e(n){var r,o,c,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=p.options[p.selectedIndex].text,o=function(){t.push(l),localStorage.setItem("article",JSON.stringify(t)),location.reload()},0!=r){e.next=6;break}p.style.border="2px dashed red",e.next=27;break;case 6:if(!t){e.next=23;break}c=!0,i=0;case 9:if(!(i<t.length)){e.next=20;break}if((s=t[i]).id!==a){e.next=17;break}return c=!1,s.qty+=Number(r),localStorage.setItem("article",JSON.stringify(t)),location.reload(),e.abrupt("break",20);case 17:i++,e.next=9;break;case 20:c&&o(),e.next=25;break;case 23:t=[],o();case 25:n.preventDefault(),n.stopPropagation();case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){try{var e=document.querySelector(".header__cart--popup"),n=t&&t.length>0,r=e.className.includes("hide");if(n&&r){var a=0;for(var o in t)a+=t[o].qty;e.classList.remove("hide"),e.innerHTML=a}}catch(e){console.error("Erreur sur l'affichage de la pop up")}}(),v(),t&&t.forEach((function(e){if(e.id===a&&e.qty>=20){u.setAttribute("disabled","disabled");var t=document.createElement("div");t.classList.add("col-12","text-center","h3","text-info"),t.innerHTML="\n        <p> Vous avez atteint le nombre maximum d'appareils ".concat(e.name,' dans votre panier </p>\n        <p class="h4"> Merci de valider votre commande, ou de continuer vos achats. </p>\n        '),i.appendChild(t)}}))})();